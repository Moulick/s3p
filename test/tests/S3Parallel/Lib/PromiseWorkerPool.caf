import &StandardImport

suite: ->
  test :pwp ->
    currentlyActive = 0
    maxActive = 0

    doWork = ->
      currentlyActive++
      maxActive = max currentlyActive, maxActive
      timeout 1
      .then -> currentlyActive--

    pwp = new PromiseWorkerPool poolSize = 10

    each til numQueued = 100
      pwp.queue doWork

    log :wat
    pwp.then ->
      log {} currentlyActive, maxActive, poolSize, numQueued
